"use strict";(self.webpackChunk_lynx_js_react_use=self.webpackChunk_lynx_js_react_use||[]).push([["7841"],{2468:function(e,n,r){r.r(n),r.d(n,{default:()=>d});var t=r(2676),s=r(453);function a(e){let n=Object.assign({h1:"h1",a:"a",blockquote:"blockquote",p:"p",strong:"strong",code:"code",h2:"h2",pre:"pre"},(0,s.ah)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.h1,{id:"useimmer",children:["useImmer",(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#useimmer",children:"#"})]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"致谢："})," 灵感来源于 ",(0,t.jsx)(n.a,{href:"https://github.com/immerjs/use-immer/tree/master",target:"_blank",rel:"noopener noreferrer",children:"use-immer"})]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["使用 ",(0,t.jsx)(n.a,{href:"https://github.com/immerjs/immer",target:"_blank",rel:"noopener noreferrer",children:"immer"})," 轻松管理复杂的嵌套状态。可以将 ",(0,t.jsx)(n.code,{children:"useImmer"})," 看作是增强版的 ",(0,t.jsx)(n.code,{children:"useState"}),"：你可以直接修改状态（例如 ",(0,t.jsx)(n.code,{children:"state.count++"}),"），而无需担心不可变性规则。"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["了解更多关于 Immer 的信息: ",(0,t.jsx)(n.a,{href:"https://github.com/immerjs/immer",target:"_blank",rel:"noopener noreferrer",children:(0,t.jsx)(n.a,{href:"https://github.com/immerjs/immer",target:"_blank",rel:"noopener noreferrer",children:"https://github.com/immerjs/immer"})})]}),"\n"]}),"\n",(0,t.jsxs)(n.h2,{id:"用法",children:["用法",(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#用法",children:"#"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"useImmer"})," 的用法与 ",(0,t.jsx)(n.code,{children:"useState"})," 非常相似，但其更新函数会提供一个可供自由修改的 ",(0,t.jsx)(n.code,{children:"draft"})," 对象。"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"import { useImmer } from '@lynx-js/react-use';\n\nconst JediProfile = () => {\n  const [jedi, updateJedi] = useImmer({\n    alias: 'SkyWalker',\n    stats: {\n      age: 19,\n      midichlorians: 20000,\n    },\n  });\n\n  function updateAlias(alias) {\n    updateJedi((draft) => {\n      draft.alias = alias;\n    });\n  }\n\n  function becomeYounger() {\n    updateJedi((draft) => {\n      draft.stats.age--;\n    });\n  }\n\n  function train() {\n    updateJedi((draft) => {\n      draft.stats.midichlorians += 500;\n    });\n  }\n\n  return (\n    <view>\n      <text>\n        Name: {jedi.alias} (Age: {jedi.stats.age})\n      </text>\n      <text>Power Level: {jedi.stats.midichlorians}</text>\n\n      <input\n        bindinput={(e) => {\n          updateAlias(e.detail.value);\n        }}\n        value={jedi.alias}\n      />\n\n      <view bindtap={becomeYounger}>Rejuvenate</view>\n      <view bindtap={train}>Train Force</view>\n    </view>\n  );\n};\n"})}),"\n",(0,t.jsxs)(n.p,{children:["当向更新函数传递一个值而不是函数时，",(0,t.jsx)(n.code,{children:"useImmer"})," hook 的行为与 ",(0,t.jsx)(n.code,{children:"useState"})," hook 相同，并使用该值更新状态。"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const [age, setAge] = useImmer(20);\n\nfunction birthDay(event) {\n  setAge(age + 1);\n  console.log(`Happy birthday #${age} Anon! hope you good`);\n}\n"})}),"\n",(0,t.jsxs)(n.h2,{id:"类型定义",children:["类型定义",(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#类型定义",children:"#"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"export type DraftFunction<S> = (draft: Draft<S>) => void;\nexport type Updater<S> = (arg: S | DraftFunction<S>) => void;\nexport type ImmerHook<S> = [S, Updater<S>];\n\nexport function useImmer<S>(initialValue: S | (() => S)): ImmerHook<S>;\n"})})]})}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,s.ah)(),e.components);return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}let d=i;i.__RSPRESS_PAGE_META={},i.__RSPRESS_PAGE_META["zh%2Fstate%2FuseImmer.md"]={toc:[{text:"用法",id:"用法",depth:2},{text:"类型定义",id:"类型定义",depth:2}],title:"useImmer",headingTitle:"useImmer",frontmatter:{}}}}]);